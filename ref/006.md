[blog:g:12921228815727798627:banner]



みなさま、ご無沙汰しております…
あの、ラクラミです…  
お待たせして申し訳ございません！！今回はmedit linkの使い方の続きでございます！

おおまかな流れを可愛い図で↓
<figure class="figure-image figure-image-fotolife" title="今回の流れ">[f:id:ainem:20250131153130p:plain]<figcaption>今回の流れ</figcaption></figure>

## **前回のおさらい**


[https://lacramy.hateblo.jp/entry/2024/08/03/065340:embed:cite]

前回の記事では、**STLデータ（IOSデータ）のCTデータへの位置合わせ** を行いました。  
今回はその続きで、グループマッチング機能をつかった位置合わせにより、咬合時の顎骨の位置を再現してみましょう！！！

<figure class="figure-image figure-image-fotolife" title="今回の完成形 咬合時の顎骨の位置が再現できている">[f:id:ainem:20250131144304p:plain]<figcaption>今回の完成形 咬合時の顎骨の位置が再現できている</figcaption></figure>


と、その前に前回のおさらいです、え、なぜかってなぜか前回の記事から悠久の時が過ぎてしまっているからに他なりませんけれども…？

### 使用データ
onedrive上にデータを置いていますので、使ってください。
[使うデータへのリンク](https://1drv.ms/f/s!AuaIEXCBrvRbgoBRZAmBkzbE9_bdNw?e=vGhowk)  


---

### **データの複製**
前回はデータ保存時に`Export`を選択し、位置を動かしたデータを元データと別に保存していましたが、今回は先にデータを複製してから位置をうごかすこととしましょう。

####  ** 手順**
1. 位置合わせを行うデータを選択  
2. **右クリックして `Duplicate` を選択**  
3. 複製したデータに、分かりやすい名前を付ける  

今回は`ios_upper-aligned`としました。

<figure class="figure-image figure-image-fotolife" title="左側のオブジェクト一覧から複製を行います">[f:id:ainem:20250131144612p:plain]<figcaption>左側のオブジェクト一覧から複製を行います</figcaption></figure>

**⚠️ 注意ポイント**  
- 名前を適当に付けてしまうと、後でどのデータがどれかわからなくなることがある(私もよくやってしまいますめんどくさいですよね)  
- デフォルトの`ios_upper_duplicated`でもいいと思います  
- 日本語名をつけることももちろん可能です。

---

### **位置合わせ**

ここから、実際の **位置合わせ（アライメント）** を行います。  

#### **🛠 手順**
  <figure class="figure-image figure-image-fotolife" title="Alignment Modeのボタン">[f:id:ainem:20250131145022p:plain]<figcaption>Alignment Modeのボタン</figcaption></figure>


1. **`Alignment Mode` を選択**  
2. **`Reference` に `seg_upper`（上顎歯牙のセグメントデータ）を設定**  
   - **`Reference` は動かない基準のデータ**  
3. **`Target` に `ios_upper-aligned`（複製したデータ）を設定**  
   - **`Target` は位置合わせを行うデータ（動かすもの）**  

<figure class="figure-image figure-image-fotolife" title="アライン画面、上は固定されて、下が動きます、まるで上下顎のように">[f:id:ainem:20250131145129p:plain]<figcaption>アライン画面、上は固定されて、下が動きます、まるで上下顎のように</figcaption></figure>


### **`Manual Alignment`（手動アライメント）**
できるだけ**一致しやすい、特徴的な3点を各データから選択して位置合わせ** します。  

<figure class="figure-image figure-image-fotolife" title="3点として犬歯中切歯第二大臼歯を選びましたよわたしは">[f:id:ainem:20250131145253p:plain]<figcaption>3点として犬歯中切歯第二大臼歯を選びましたよわたしは</figcaption></figure>

**選択するポイントのコツ**
- できるだけ歪んでいないところを選択する  
- 3点が直線上に並ばないようにする  
- 3点は離れている方が精度が高くなる

**位置合わせ完了！**  
ここまでで、**上顎の口腔内スキャンデータをCTデータにマッチングする処理が完了** しました。  

<figure class="figure-image figure-image-fotolife" title="前回のを終えたらこうなるはず">[f:id:ainem:20250131145439p:plain]<figcaption>前回のを終えたらこうなるはず</figcaption></figure>

---

# **グループマッチング**
ここから、いよいよ **グループマッチング** を行います。  

---

## **やりたいこと①**
 **下顎の咬合時データもCTにマッチングしたい！**  
<figure class="figure-image figure-image-fotolife" title="やりたいこと１">[f:id:ainem:20250131145514p:plain]<figcaption>やりたいこと１</figcaption></figure>
でも、下顎をそのまま下顎のCTに合わせようとすると開口時の位置になってしまいます…一体どうすれば… 
そう、そこでグループマッチングなのです！

<figure class="figure-image figure-image-fotolife" title="そうだ、ひとかたまりにすれば">[f:id:ainem:20250131145932p:plain]<figcaption>そうだ、ひとかたまりにすれば</figcaption></figure>

---

### **グループを対象とした位置合わせ**

まず、**位置合わせの対象となるデータを再度選択** します。  

### ** 手順**
1. **`Alignment Mode` を開く**  
2. **`Reassign Target and Reference` を選択**  

<figure class="figure-image figure-image-fotolife" title="アライメントモード">[f:id:ainem:20250131150104p:plain]<figcaption>アライメントモード</figcaption></figure>


<figure class="figure-image figure-image-fotolife" title="そのままだと前に選択したデータしか表示されないので、こちらをクリック">[f:id:ainem:20250131150123p:plain]<figcaption>そのままだと前に選択したデータしか表示されないので、こちらをクリック</figcaption></figure>


---

### **位置合わせの対象選択**

<figure class="figure-image figure-image-fotolife" title="複数選択するのがカギ">[f:id:ainem:20250131150227p:plain]<figcaption>複数選択するのがカギ</figcaption></figure>

✅ **重要ポイント**
- 左下の **`Align Target Data in Group` を選択**
これにより、**複数のデータをまとめて動かすことが可能** になる！  

今回は、  
- **`Reference` に `ios_upper-aligned`（すでにCTと位置合わせ済みのデータ）を設定**  
- **`Target` に `ios_upper` と `ios_lower` の 2つを選択**  

これで、**上下顎のスキャンデータを一緒に移動できる状態** になりました。  

---

### **自動位置合わせ**
今回は`ios_upper`と`ios_upper-aligned`が全く同じデータで位置が違うだけなので、`Auto Alignment`の出番です。  
ボタンひとつで簡単に位置合わせが可能です！  

<figure class="figure-image figure-image-fotolife" title="ボタン一つでポチっとな">[f:id:ainem:20250131150324p:plain]<figcaption>ボタン一つでポチっとな</figcaption></figure>



** 下顎 IOS データの位置合わせ完了！**  


<figure class="figure-image figure-image-fotolife" title="第一段階完了">[f:id:ainem:20250131150917p:plain]<figcaption>第一段階完了</figcaption></figure>

## **やりたいこと②**
 **下顎のCTデータを下顎IOSデータに位置合わせし、咬合時のCTデータを作成する！**  



ここでは、  
- **`Reference` に `ios_lower`（下顎の口腔内スキャンデータ）を設定**  
- **`Target` に `seg_lower_teeth` と `seg_mandible`（CTの下顎データ）を選択**  


<figure class="figure-image figure-image-fotolife" title="データ選択">[f:id:ainem:20250131151119p:plain]<figcaption>データ選択</figcaption></figure>

## **データが重なって位置合わせしにくい場合**
今回`ios_lower`で隠れて`seg_lower_teeth`が見えにくい位置にあります。そんなときは、 
### 表示／非表示の切り替え
 **オブジェクトの表示／非表示を切り替える**ことで、快適に作業することができます。  
<figure class="figure-image figure-image-fotolife" title="オブジェクト一覧から表示/非表示の切り替え">[f:id:ainem:20250131151236p:plain]<figcaption>オブジェクト一覧から表示/非表示の切り替え</figcaption></figure>


### **`Target` のデータの回転**
**`Target` に選択した `seg_lower_teeth` と `seg_mandible` は `右クリック → ドラッグ` で回転可能！**  
`Reference`と`Target`が同じ角度になるように回転させると操作しやすいですよね。

---

## ** 完成！**
<figure class="figure-image figure-image-fotolife" title="完成！！">[f:id:ainem:20250131151423p:plain]<figcaption>完成！！</figcaption></figure>
---


# **✨ 次回予告：「ブーリアン演算」**
次回は、複数のデータを「合成・重なりを削除・重なりのみを抽出」することのできる、**ブーリアン演算**について書こうと思っています。乞うご期待！乞いてます、ご期待！！！！
